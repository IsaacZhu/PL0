# 9 EXIT 的实现

## 9.1 实现的功能

添加系统级指令 exit，当程序遇到这条指令后，整个 pl0 指令流会无条件终止，程序退出。

## 9.2 实现的原理

pl0 的解释器会以 pc == 0 作为最后一条指令已经执行完毕的标志，因此在 exit 将 pc 标志为“结束”就可以了。

## 9.3 实现的思路

pl0 的解释器中有无条件跳转的 JMP 指令，我们将 exit 解释为 JMP 0，就可以将 pc 置0。

## 9.4 具体实现

在 statement 中，如果遇到 exit 标志，则说明需要终止程序。此时生成一条 (JMP, 0, 0) 的指令就可以将 pc 置零，
程序停机。

## 9.5 效果

```pl0

var a,b,c;
procedure foo(p1);
begin
    if p1 > 99 then exit;
    else b := p1*10;
end;

begin
	a := 1;
    c := 100;
    foo(c);
    a := b + c;
end.

```

当解释器遇到 exit 语句，哪怕是若干层函数调用中，都会将 pc 置零，程序立刻停机，后面的指令不再执行。

## 9.6 后续工作

无