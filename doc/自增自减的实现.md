# ? 自增自减的实现

## ?.1 实现的功能

类似自增自减运算符的支持。

## ?.2 实现的原理

在解释器中新增指令 INC 与 DEC 用于将栈顶数值自增或自减。

然后当遇到 SYM\_INC 或 SYM\_DEC 则看它是左操作符还是右操作符，然后生成相应的指令序列。

## ?.3 实现的思路

指令 INC 与 DEC 就是简单的 ++/-- stack[top]。

当自增自减出现在 statement 中时，如果是 ++/-- var 则当做 factor 处理。而如果是 var ++/--，
则将其视为最简单的自增自减而不用考虑栈顶值的问题。

在 factor 中则按 factor 处理。

## ?.4 具体实现

当自增自减出现在 factor 中时，分为两种情况：var ++/-- 与 ++/-- var。

其中第一种由于涉及左递归，因此考虑在 var 处理完或者右括号结束时继续循环读取下一个符号，如果是 INC 或 DEC，
则将栈顶的值自增或自减、存入、取出以及反向操作。即如果 a := 10， 当 a ++ 时，首先将 10 取出入栈，然后通过 INC 
指令将栈顶的值自增为 11，然后将 11 存回 a，然后将 a 的值再次取出入栈，然后反向操作将 11 DEC 为10。

第二种则相对简单，直接 INC 或 DEC，然后存入取出就可以了。

## ?.5 效果

```pl0

var a,b,c,d;
begin
        a := 88;
        printf("@0, @1, @2, @3\n", ++++++a, a ++++++, ++(a ++++)++, a--++--);
        //注意 @2 不是合法的写法，但是没检查
        b := 77;
        printf("@0\n", b);
        b ++++++++;
        printf("@0\n", b);
        ------ b;
        printf("@0\n", b);
end.

```


输出结果

```

Begin executing PL/0 program.
91, 91, 93, 93
77
81
78
End executing PL/0 program.

```


## ?.6 后续工作

无